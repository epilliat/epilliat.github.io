<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.22">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Hypothesis Testing, Exam 2025 – Emmanuel Pilliat</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-7b4406b7675125bc2ba204020e191172.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-338eaa8bf8d7f1eb506da55f2b711d05.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Emmanuel Pilliat</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Presentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../teaching.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/epilliat"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fr.linkedin.com/in/emmanuel-pilliat-18ab2b180"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exercice-1-test-dune-préférence-pour-les-sources-dénergie-renouvelables-ou-non-renouvelables" id="toc-exercice-1-test-dune-préférence-pour-les-sources-dénergie-renouvelables-ou-non-renouvelables" class="nav-link active" data-scroll-target="#exercice-1-test-dune-préférence-pour-les-sources-dénergie-renouvelables-ou-non-renouvelables">Exercice 1 : Test d’une préférence pour les sources d’énergie renouvelables ou non renouvelables</a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions :</a></li>
  <li><a href="#exercice-2-surveillance-environnementale-de-la-pollution-fluviale" id="toc-exercice-2-surveillance-environnementale-de-la-pollution-fluviale" class="nav-link" data-scroll-target="#exercice-2-surveillance-environnementale-de-la-pollution-fluviale">Exercice 2 : Surveillance environnementale de la pollution fluviale</a>
  <ul class="collapse">
  <li><a href="#questions-1" id="toc-questions-1" class="nav-link" data-scroll-target="#questions-1">Questions :</a></li>
  </ul></li>
  <li><a href="#exercice-3-analyse-de-la-distribution-des-habitats-lors-de-la-migration-des-oiseaux" id="toc-exercice-3-analyse-de-la-distribution-des-habitats-lors-de-la-migration-des-oiseaux" class="nav-link" data-scroll-target="#exercice-3-analyse-de-la-distribution-des-habitats-lors-de-la-migration-des-oiseaux">Exercice 3 : Analyse de la distribution des habitats lors de la migration des oiseaux</a>
  <ul class="collapse">
  <li><a href="#questions-2" id="toc-questions-2" class="nav-link" data-scroll-target="#questions-2">Questions :</a></li>
  </ul></li>
  <li><a href="#exercice-4" id="toc-exercice-4" class="nav-link" data-scroll-target="#exercice-4">Exercice 4</a>
  <ul class="collapse">
  <li><a href="#productivité-des-employés-entre-départements" id="toc-productivité-des-employés-entre-départements" class="nav-link" data-scroll-target="#productivité-des-employés-entre-départements">Productivité des employés entre départements</a></li>
  <li><a href="#questions-3" id="toc-questions-3" class="nav-link" data-scroll-target="#questions-3">Questions</a></li>
  </ul></li>
  <li><a href="#questions-de-cours" id="toc-questions-de-cours" class="nav-link" data-scroll-target="#questions-de-cours">Questions de cours</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to Hypothesis Testing, Exam 2025</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note sur la correction
</div>
</div>
<div class="callout-body-container callout-body">
<p>Comme répété à plusieurs reprises en cours, la qualité de la rédaction ainsi que les détails d’explications sont grandement pris en compte dans l’évaluation, surtout pour les <span style="background-color: yellow;">introductions des modèles</span> (premières questions des exercices).</p>
</div>
</div>
<section id="exercice-1-test-dune-préférence-pour-les-sources-dénergie-renouvelables-ou-non-renouvelables" class="level2">
<h2 class="anchored" data-anchor-id="exercice-1-test-dune-préférence-pour-les-sources-dénergie-renouvelables-ou-non-renouvelables">Exercice 1 : Test d’une préférence pour les sources d’énergie renouvelables ou non renouvelables</h2>
<p>Nous cherchons à déterminer si les citoyens d’une région ont une quelconque préférence pour les sources d’énergie renouvelables (par exemple, solaire, éolienne) ou les sources d’énergie non renouvelables (par exemple, charbon, gaz naturel). Nous supposons que, a priori, il n’y a aucune préférence en moyenne. Nous interrogeons <span class="math inline">\(n\)</span> individus, et nous notons <span class="math inline">\(X\)</span> le nombre de répondants qui préfèrent les énergies renouvelables.</p>
</section>
<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions :</h2>
<ol type="1">
<li>Formalisez le problème de test d’hypothèse, et définissez <span class="math inline">\(H_0\)</span> et <span class="math inline">\(H_1\)</span>​. Indiquez si ce test est unilatéral ou bilatéral.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>On observe <span class="math inline">\(X\)</span> le nombre d’individus qui préfèrent les ENR.</li>
<li>On suppose que <span style="background-color: yellow;"><span class="math inline">\(X\)</span> suit une loi <span class="math inline">\(Bin(n,p)\)</span></span>, où <span style="background-color: yellow;"><span class="math inline">\(p\)</span> est un paramètre inconnu</span>.</li>
<li>On considère le problème de test: <span class="math inline">\(H_0: p=1/2\)</span> VS <span class="math inline">\(H_1: p\neq 1/2\)</span></li>
</ul>
<p>C’est un problème de test <span style="background-color: yellow;">bilatéral</span></p>
</div>
</div>
<ol start="2" type="1">
<li>Nous interrogeons <span class="math inline">\(n=100\)</span> individus, et <span class="math inline">\(X=58\)</span> préfèrent les sources d’énergie renouvelables. Écrivez la p-valeur en fonction de <span class="math inline">\(F\)</span>, la fonction de répartition d’une distribution Binomiale Bin<span class="math inline">\((100,0.5)\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p><span style="background-color: yellow;">Sous <span class="math inline">\(H_0\)</span>, <span class="math inline">\(X\)</span> suit une loi <span class="math inline">\(Bin(100, 0.5)\)</span></span> de cdf <span class="math inline">\(F\)</span>. Ainsi, <span class="math inline">\(p_{valeur} = 2\min(\mathbb P(X \leq 58), \mathbb P(X \geq 58)) =  2\mathbb P(X \geq 58) = 2(1- F(57))\)</span>.<br>
d’où <span style="background-color: yellow;"><span class="math inline">\(p_{valeur} = 2(1- F(57))\)</span></span>.<br>
(58 accepté aussi car <span class="math inline">\(\mathbb P(X=58)\)</span> est petit)</p>
</div>
</div>
<ol start="3" type="1">
<li>Écrivez une ligne de code qui calculerait la p-valeur exacte en Julia, Python, ou R.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fl">2</span><span class="fu">*</span>(<span class="fl">1</span><span class="fu">-cdf</span>(<span class="fu">Binomial</span>(<span class="fl">100</span>, <span class="fl">0.5</span>), <span class="fl">57</span>)) <span class="co"># Julia</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fl">2</span><span class="fu">*</span>(<span class="fl">1</span><span class="fu">-pbinom</span>(<span class="fl">57</span>,<span class="fl">100</span>,<span class="fl">0.5</span>)) <span class="co"># R</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultat: 0.133</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="4" type="1">
<li>Donnez une approximation de la p-valeur en utilisant une approximation gaussienne et le graphique de la fonction de répartition de <span class="math inline">\(\mathcal N(0,1)\)</span> fourni dans le sujet. Quelle est votre conclusion ?</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><span style="background-color: yellow;">Sous <span class="math inline">\(H_0\)</span>, <span class="math inline">\(\mathbb E_0[X]=n/2\)</span> et <span class="math inline">\(\mathbb V_0(X)=n\frac{1}{2}(1-\frac{1}{2})=n/4\)</span></span><br>
</p>
<p>On renormalise <span class="math inline">\(X\)</span> pour obtenir la statistique de test suivante: <span class="math display">\[\psi(X) = \frac{X-\mathbb E_0[X]}{\sqrt{\mathbb V_0(X)}}=\frac{X-n/2}{\sqrt{n/4}}\]</span></p>
<p>Lorsque <span class="math inline">\(n \to \infty\)</span>, <span class="math inline">\(\psi(X)\)</span> converge en loi vers <span class="math inline">\(\mathcal N(0,1)\)</span>. Ainsi, on obtient suite à cette approximation Gaussienne (<span style="background-color: yellow;"><span class="math inline">\(n/2\)</span> est assez grand</span>):</p>
<p><span class="math display">\[
p_{valeur} = 2\mathbb P(\psi(X) \geq \psi(X_{obs})) \asymp 2\mathbb P(Z \geq \psi(58)),
\]</span> où <span class="math inline">\(Z\)</span> est une VA qui suit une loi <span class="math inline">\(\mathcal N(0,1)\)</span> sous <span class="math inline">\(\mathbb P\)</span>. On calcule <span class="math inline">\(\psi(58) \asymp 1.6\)</span>, et par lecture graphique, <span style="background-color: yellow;"><span class="math inline">\(2*P(Z \geq \psi(58)) \asymp 0.11\)</span></span></p>
<p>La <span class="math inline">\(p_{valeur}\)</span> est grande, <span style="background-color: yellow;">on ne donc rejette pas à un niveau de <span class="math inline">\(5\%\)</span></span>.</p>
</div>
</div>
<ol start="5" type="1">
<li>Redéfinissez l’hypothèse alternative <span class="math inline">\(H_1\)</span>​ et calculez une p-valeur approximative si nous cherchons à déterminer si les citoyens ont une préférence pour :
<ol type="a">
<li>les sources d’énergie renouvelables.</li>
<li>les sources d’énergie non renouvelables. Quelles sont vos conclusions pour ces deux autres problèmes ?</li>
</ol></li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p>Les problèmes de test deviennent unilatéraux.</p>
<ol type="a">
<li><span class="math inline">\(H_1: p &gt; 0.5\)</span>, <span class="math inline">\(p_{valeur} \asymp 0.11/2 \asymp 0.055\)</span> on pourrait rejeter à un niveau <span class="math inline">\(10\%\)</span></li>
<li><span class="math inline">\(H_1: p &lt; 0.5\)</span> , <span class="math inline">\(p_{valeur} \asymp (1-0.11)/2 \asymp 0.445\)</span>, on ne rejette pas.</li>
</ol>
</div>
</div>
<p><img src="cdfs/gauss.svg" class="img-fluid"></p>
</section>
<section id="exercice-2-surveillance-environnementale-de-la-pollution-fluviale" class="level2">
<h2 class="anchored" data-anchor-id="exercice-2-surveillance-environnementale-de-la-pollution-fluviale">Exercice 2 : Surveillance environnementale de la pollution fluviale</h2>
<p>Une agence environnementale surveille les niveaux de pollution d’une rivière pour déterminer si une usine à proximité provoque une <strong>augmentation</strong> de la concentration de produits chimiques nocifs. La concentration cible pour un produit chimique spécifique est de <span class="math inline">\(15 \, \text{ppm}\)</span> (parties par million), ce qui est considéré comme sûr pour la vie aquatique. Pour un échantillon de <span class="math inline">\(n = 20\)</span> prélèvements d’eau effectués en aval de l’usine, la concentration moyenne empirique est <span class="math inline">\(\bar{X}_n = 16,3 \, \text{ppm}\)</span>, et la variance empirique est <span class="math inline">\(S^2_n = 2,4 \, \text{ppm}^2\)</span>.</p>
<p><strong>A priori</strong>, on suppose que la rivière respecte le seuil de pollution sans danger de <span class="math inline">\(15 \, \text{ppm}\)</span>.</p>
<p>Nous visons à tester, avec un niveau de signification <span class="math inline">\(\alpha = 0,05\)</span>, si la concentration chimique en aval dépasse le seuil de sécurité, indiquant une pollution provenant de l’usine.</p>
<section id="questions-1" class="level3">
<h3 class="anchored" data-anchor-id="questions-1">Questions :</h3>
<ol type="1">
<li>En utilisant une hypothèse Gaussienne, formalisez le problème de test d’hypothèse et définissez <span class="math inline">\(H_0\)</span> et <span class="math inline">\(H_1\)</span>. S’agit-il d’un test unilatéral ou bilatéral ?</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>On observe <span class="math inline">\((X_1, \dots, X_n)\)</span> les concentrations des prélèvement <span style="background-color: yellow;">en ppm</span> (toujours bien de mettre les unités)</li>
<li>On suppose que les <span style="background-color: yellow;"><span class="math inline">\(X_i\)</span> sont iid de loi <span class="math inline">\(\mathcal N(\mu, \sigma^2)\)</span> où <span class="math inline">\(\mu\)</span> et <span class="math inline">\(\sigma^2\)</span> sont des paramètres inconnus</span></li>
<li>On souhaite tester s’il y a un problème de pollution, cad<br>
<span class="math inline">\(H_0: \mu = 15\)</span> ppm VS <span class="math inline">\(H_1: \mu &gt; 15\)</span> ppm</li>
</ul>
<p>C’est un problème de test <span style="background-color: yellow;">unilatéral droit</span> (<span class="math inline">\(\mu \leq 15\)</span> ppm aussi accepté pour <span class="math inline">\(H_0\)</span>)</p>
</div>
</div>
<ol type="1">
<li>Définissez la statistique de test. Quelle est sa distribution sous <span class="math inline">\(H_0\)</span> ?</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p>On utilise la statistique de test de Student <span class="math display">\[\psi(X) = \sqrt{n}\frac{\overline X - 15}{\hat \sigma},\]</span></p>
<p>où <span class="math inline">\(\overline X=\frac{1}{n}\sum_{i=1}^n X_i\)</span> et <span class="math inline">\(\hat \sigma^2 = \tfrac{1}{n-1}\sum_{i=1}^n (X_i-\overline X)^2\)</span> est un estimateur non biaisé de <span class="math inline">\(\sigma^2\)</span> sous <span class="math inline">\(H_0\)</span>. Comme les <span class="math inline">\(X_i\)</span> sont iid de loi normale, <span class="math inline">\(\psi(X)\)</span> suit une loi de student <span class="math inline">\(\mathcal T(n-1)\)</span> sous <span class="math inline">\(H_0\)</span>. <span style="background-color: lightgreen;">Ce n’est pas une approximation ici, on peut même dire que <span class="math inline">\(\psi\)</span> est une statistique de test pivot</span></p>
</div>
</div>
<ol start="2" type="1">
<li>Déterminez la zone de rejet. Vous pouvez utiliser une approximation Gaussienne et le graphe de l’exercice 1.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p>On souhaite tester (à droite) au niveau <span class="math inline">\(0.05\)</span>. Ainsi, on rejette si <span class="math inline">\(\psi(X) \geq t_{0.95}\)</span>, où <span class="math inline">\(t_{0.95}\)</span> est le quantile <span class="math inline">\(0.95\)</span> de <span class="math inline">\(\mathcal T(n-1)\)</span></p>
<p>Lorsque <span class="math inline">\(n\)</span> tend vers <span class="math inline">\(+\infty\)</span>, <span class="math inline">\(\mathcal T(n-1)\)</span> converge en loi vers <span class="math inline">\(\mathcal N(0,1)\)</span>. On approxime donc <span class="math inline">\(t_{0.95}\)</span> par le quantile de la loi Gaussienne (inverse de la cdf sur le graphe), d’où <span class="math inline">\(t_{0.95} \asymp 1.6\)</span></p>
<p><span style="background-color: yellow;">On rejette si <span class="math inline">\(\psi(X) \geq 1.6\)</span></span></p>
</div>
</div>
<ol start="3" type="1">
<li>Ecrivez une ligne de code permettant de calculer le seuil de rejet exact.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">TDist</span>(<span class="fl">19</span>), <span class="fl">0.95</span>) <span class="co"># julia</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.95</span>,n) <span class="co"># R, (1.73 légèrement plus grand que 1.6)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="4" type="1">
<li>La rivière présente-t-elle une concentration chimique accrue qui pourrait indiquer une pollution provenant de l’usine ?</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p>On calcule <span class="math inline">\(\psi(X_{\mathrm{obs}}) = 3.75\)</span>, <span style="background-color: yellow;">on rejette donc <span class="math inline">\(H_0\)</span></span>, la rivière est peut être polluée</p>
</div>
</div>
</section>
</section>
<section id="exercice-3-analyse-de-la-distribution-des-habitats-lors-de-la-migration-des-oiseaux" class="level2">
<h2 class="anchored" data-anchor-id="exercice-3-analyse-de-la-distribution-des-habitats-lors-de-la-migration-des-oiseaux">Exercice 3 : Analyse de la distribution des habitats lors de la migration des oiseaux</h2>
<p>Un chercheur en faune sauvage étudie le comportement d’une certaine espèce d’oiseaux qui migrent vers une réserve naturelle. Le chercheur a une hypothèse sur la façon dont les oiseaux se répartissent entre différents types d’habitats dans la réserve. La distribution attendue, basée sur des données historiques, est la suivante :</p>
<ul>
<li><strong>Prairie</strong> : 40%</li>
<li><strong>Zones humides</strong> : 30%</li>
<li><strong>Forêts</strong> : 20%</li>
<li><strong>Zones rocheuses</strong> : 10%</li>
</ul>
<p>Pour tester cette hypothèse, le chercheur observe 200 oiseaux et enregistre leurs préférences d’habitat. Les comptages observés sont les suivants :</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Habitat</th>
<th>Prairie</th>
<th>Zones humides</th>
<th>Forêts</th>
<th>Zones rocheuses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Observé</td>
<td>90</td>
<td>60</td>
<td>30</td>
<td>20</td>
</tr>
</tbody>
</table>
<section id="questions-2" class="level3">
<h3 class="anchored" data-anchor-id="questions-2">Questions :</h3>
<ol type="1">
<li>Formalisez le problème de test d’hypothèse et définissez <span class="math inline">\(H_0\)</span> et <span class="math inline">\(H_1\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>On observe <span class="math inline">\((X_1, X_2,X_3,X_4)\)</span> les effectifs d’oiseaux présent respectivement dans les Prairie,…, zones rocheuses.</li>
<li>On suppose que le vecteur <span class="math inline">\((X_1, X_2,X_3,X_4)\)</span> suit une <span style="background-color: yellow;">loi multinomiale de paramètre <span class="math inline">\(n=200\)</span> et <span class="math inline">\(q=(q_1,q_2,q_3,q_4)\)</span> inconnu</span></li>
<li>On veut tester si les observations correspondent à la distribution attendue, c’est à dire <span class="math inline">\(H_0: q=(0.4,0.3,0.2,0.1)\)</span> VS <span class="math inline">\(H_1: q\neq (0.4,0.3,0.2,0.1)\)</span> Ce problème correspond au <span style="background-color: yellow;">test d’adéquation du Chi2 (Goodness of fit)</span>.</li>
</ul>
</div>
</div>
<ol type="1">
<li>Calculez les effectifs attendus.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Habitat</th>
<th>Prairie</th>
<th>Zones humides</th>
<th>Forêts</th>
<th>Zones rocheuses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Observé (<span class="math inline">\(X_i\)</span>)</td>
<td>90</td>
<td>60</td>
<td>30</td>
<td>20</td>
</tr>
<tr class="even">
<td>Attendus (<span class="math inline">\(E_i\)</span>)</td>
<td>80</td>
<td>60</td>
<td>40</td>
<td>20</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol start="2" type="1">
<li>Calculez la statistique du chi-deux.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(\psi(X) = \sum_{i=1}^4 \frac{(X_i - E_i)^2}{E_i} = 100/80 + 100/40 = 3.75\)</span></p>
</div>
</div>
<ol start="3" type="1">
<li>Déterminez le degré de liberté <span class="math inline">\(df\)</span> de la statistique du chi-deux, et lisez la p-value sur le graphique suivant de la fonction de répartition.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Lorsque <span class="math inline">\(n \to +\infty\)</span>, <span class="math inline">\(\psi(X)\)</span> converge en loi vers une loi de <span class="math inline">\(\chi^2\)</span> de degré <span class="math inline">\(df=3\)</span>. On lit <code>pvaleur = 1-cdf(Chisq(df), 3.75)=0.3</code></p>
</div>
</div>
<ol start="4" type="1">
<li>Quelle est votre conclusion ?</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p>La <span class="math inline">\(p_{valeur}\)</span> est assez grande, la distribution colle avec celle attendue et on ne rejette donc pas <span class="math inline">\(H_0\)</span>.</p>
</div>
</div>
<p><img src="cdfs/chi3.svg" class="img-fluid"></p>
</section>
</section>
<section id="exercice-4" class="level2">
<h2 class="anchored" data-anchor-id="exercice-4">Exercice 4</h2>
<section id="productivité-des-employés-entre-départements" class="level3">
<h3 class="anchored" data-anchor-id="productivité-des-employés-entre-départements">Productivité des employés entre départements</h3>
<p>Une entreprise souhaite évaluer si un nouveau style de management a eu un effet uniforme sur la productivité des employés dans cinq départements. Chaque département a adopté une variation spécifique du style de management pendant trois mois, et l’entreprise a enregistré le nombre moyen de tâches accomplies par employé durant cette période.</p>
<p><strong>Données :</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Département</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nombre d’employés</td>
<td>12</td>
<td>10</td>
<td>8</td>
<td>9</td>
<td>11</td>
</tr>
<tr class="even">
<td>Moyenne des tâches accomplies</td>
<td>72,4</td>
<td>68,9</td>
<td>75,6</td>
<td>74,3</td>
<td>69,7</td>
</tr>
<tr class="odd">
<td>Variance des tâches</td>
<td>8,5</td>
<td>9,2</td>
<td>10,1</td>
<td>7,8</td>
<td>9,6</td>
</tr>
</tbody>
</table>
<p>L’entreprise cherche à comprendre si les niveaux de productivité varient significativement entre les départements, indiquant que les styles de management pourraient avoir des impacts différents.</p>
<p>Soit <span class="math inline">\(d=5\)</span> le nombre de départements et <span class="math inline">\(N_{\text{tot}} = 50\)</span> le nombre total d’employés. Pour tout département <span class="math inline">\(j\)</span>, nous notons <span class="math inline">\(N_k\)</span> le nombre d’employés dans le département <span class="math inline">\(k\)</span>, et <span class="math inline">\(P_{ik}\)</span> le nombre de tâches accomplies par l’employé <span class="math inline">\(i\)</span> dans le département <span class="math inline">\(k\)</span>. Nous supposons que les <span class="math inline">\(P_{ik}\)</span> sont indépendants et suivent une distribution normale de moyenne <span class="math inline">\(\mu_k\)</span> et de variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Nous écrivons <span class="math display">\[
\left.\begin{array}{cl}
\overline P_k &amp;= \frac{1}{N_k} \sum_{i=1}^{N_k} P_{ik}\\
\overline{P} &amp;= \frac{1}{N_{\mathrm{tot}}} \sum_{k=1}^d N_k\overline P_{k}\end{array}\right.
\left.\begin{array}{cl}
V_k &amp;= \frac{1}{N_k}\sum_{i=1}^{N_k} (P_{ik} - \overline P_k)^2
\\
V_W &amp;= \frac{1}{N_{\mathrm{tot}}} \sum_{k=1}^d N_kV_k\\
V_B &amp;= \frac{1}{N_{\mathrm{tot}}}\sum_{k=1}^{d} N_k(\overline P_k - \overline P)^2\\
V_{T} &amp;= \frac{1}{N_{\mathrm{tot}}}\sum_{k=1}^d\sum_{i=1}^{N_k} (P_{ik} - \overline P)^2
\end{array}
\right.
\]</span></p>
</section>
<section id="questions-3" class="level3">
<h3 class="anchored" data-anchor-id="questions-3">Questions</h3>
<ol type="1">
<li>Définissez les hypothèses du problème pour tester si les styles de management ont eu un impact uniforme sur la productivité.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Dans le département <span class="math inline">\(k\)</span>, on observe <span class="math inline">\(P_{ik}\)</span> le nombre de tâche accompli par l’employé <span class="math inline">\(i\)</span></li>
<li>On suppose que les <span class="math inline">\(P_{ik}\)</span> sont <span style="background-color: yellow;">indépendants</span>, et que <span style="background-color: yellow;"><span class="math inline">\(P_{ik}\)</span> suit une <span class="math inline">\(\mathcal N(\mu_k, \sigma^2)\)</span> où <span class="math inline">\((\mu_1, \dots, \mu_5)\)</span> et <span class="math inline">\(\sigma^2\)</span> sont des paramètres inconnus</span>.</li>
<li>Problème de test: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 = \dots = \mu_5\)</span> VS <span class="math inline">\(H_1\)</span>: <span class="math inline">\(\exists k,l\)</span> tels que <span class="math inline">\(\mu_k \neq \mu_l\)</span></li>
</ul>
</div>
</div>
<ol start="2" type="1">
<li>Donnez une brève interprétation de chacune des quantités <span class="math inline">\(\overline{P}_k\)</span>, <span class="math inline">\(\overline{P}\)</span>, <span class="math inline">\(V_k\)</span>, <span class="math inline">\(V_W\)</span>, <span class="math inline">\(V_B\)</span>, <span class="math inline">\(V_T\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cf cours</p>
</div>
</div>
<ol start="3" type="1">
<li>Démontrez la formule d’analyse de la variance : <span class="math inline">\(V_T = V_W + V_B\)</span></li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Exercice à refaire</p>
</div>
</div>
<ol start="4" type="1">
<li>Calculez <span class="math inline">\(\overline{P}\)</span>, <span class="math inline">\(V_W\)</span>, <span class="math inline">\(V_B\)</span>, et <span class="math inline">\(V_T\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>On applique les formules…<br>
<span class="math inline">\(\overline P=71.96\)</span><br>
<span class="math inline">\(V_W = 9.01\)</span><br>
<span class="math inline">\(V_B=6.15\)</span><br>
<span class="math inline">\(V_T=15.16\)</span><br>
</p>
</div>
</div>
<ol start="5" type="1">
<li>Exprimez la statistique de test ANOVA en termes de <span class="math inline">\(V_W\)</span> et <span class="math inline">\(V_B\)</span>.</li>
<li>Quelles sont les distributions de <span class="math inline">\(N_k V_k\)</span> et de <span class="math inline">\(N_{\mathrm{tot}}V_W\)</span> sous <span class="math inline">\(H_0\)</span> ? Changent-elles sous <span class="math inline">\(H_1\)</span> ?</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(N_kV_k\)</span> suit une <span style="background-color: yellow;">loi <span class="math inline">\(\sigma^2\chi^2(N_k-1)\)</span></span>.<br>
Ainsi, <span class="math inline">\(N_{\mathrm{tot}}V_W/\sigma^2\)</span> suit une loi <span class="math inline">\(\chi^2\)</span> de degré <span class="math inline">\(\sum_{k=1}^5(N_k-1) = N_{tot}-5\)</span> <span style="background-color: yellow;">Ces lois ne changes pas sous <span class="math inline">\(H_1\)</span>!</span> <span style="background-color: lightgreen;">C’est en fait la loi de la variance interclasses <span class="math inline">\(V_B\)</span> qui va changer sous <span class="math inline">\(H_1\)</span></span>.</p>
</div>
</div>
<ol start="7" type="1">
<li>Rappelez la définition de la statistique de test ANOVA, donnez sa distribution <span class="math inline">\(\mathcal D\)</span> sous <span class="math inline">\(H_0\)</span> et effectuez le test ANOVA au niveau <span class="math inline">\(\alpha =0,05\)</span>. On donne les quantiles <span class="math inline">\(0.05\)</span> et <span class="math inline">\(0.95\)</span> de <span class="math inline">\(\mathcal D\)</span>: <span class="math inline">\(0.18\)</span> and <span class="math inline">\(2.58\)</span>. Concluez si la productivité diffère significativement entre les départements.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p>La statistique ANOVA se définit comme <span class="math inline">\(\psi((P_{ik})) = \frac{N_k-1}{d-1}\frac{V_B}{V_W}\)</span>. Ici, on calcule <span class="math inline">\(\psi((P_{ik}))=7.7\)</span>. Comme <span class="math inline">\(7.7 &gt; 2.5\)</span> (On regarde le quantile à droite), on rejette <span class="math inline">\(H_0\)</span> au niveau <span class="math inline">\(0.05\)</span>. La productivité n’est pas homogène entre les départements.</p>
</div>
</div>
</section>
</section>
<section id="questions-de-cours" class="level2">
<h2 class="anchored" data-anchor-id="questions-de-cours">Questions de cours</h2>
<ol type="1">
<li>Rappelez la définition d’une statistique de test <span class="math inline">\(\psi\)</span> et d’un test (ou règle de décision) <span class="math inline">\(T\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Une statistique de test <span class="math inline">\(\psi\)</span> est une fonction mesurable des donnée à valeurs réelles et qui ne dépend pas des paramètres inconnus du modèle.</li>
<li>Une règle de décision <span class="math inline">\(T\)</span> a la même définition, sauf qu’elle prend ses valeurs dans <span class="math inline">\(\{0,1\}\)</span> (<span class="math inline">\(0\)</span> correspond à conserver <span class="math inline">\(H_0\)</span> et <span class="math inline">\(1\)</span> correspond au rejet de <span class="math inline">\(H_0\)</span>)</li>
</ul>
</div>
</div>
<ol start="2" type="1">
<li>Quels sont les deux types d’erreur que nous pouvons commettre ?</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cf cours</p>
</div>
</div>
<ol start="3" type="1">
<li>Pour une statistique de test <span class="math inline">\(\psi\)</span> donnée et un problème de test bilatéral, rappelez la définition de la p-valeur.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p>Soit un problème de test où <span class="math inline">\(H_0\)</span> est simple. Soit <span class="math inline">\(X\)</span> la variable aléatoire, et <span class="math inline">\(X_{obs}\)</span> une observation (c’est formellement une réalisation de <span class="math inline">\(X\)</span>)</p>
<p>Pour un problème de test <span style="background-color: yellow;">bilatéral</span> et une statistique de test <span class="math inline">\(\psi\)</span> donnée, la pvaleur s’écrit <span class="math inline">\(2*\min(\mathbb P(\psi(X) \geq \psi(X_{\mathrm{obs}})), \mathbb P(\psi(X) \leq \psi(X_{\mathrm{obs}})))\)</span></p>
</div>
</div>
<ol start="4" type="1">
<li>Énoncez le théorème de Neyman-Pearson.</li>
</ol>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Réponse
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dans le cas d’un problème <span style="background-color: yellow;">simple VS simple</span>, le rapport de vraissemblance est optimal pour un niveau de test <span class="math inline">\(\alpha\)</span> fixé, au sens où aucun test de niveau <span class="math inline">\(\alpha\)</span> ne peut avoir une plus grande puissance. Cf cours</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>