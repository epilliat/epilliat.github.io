<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 340">
  <!-- Background implied dark -->
  
  <!-- Step 0: Initial - 8 values in lanes 1-8 -->
  <text x="15" y="45" fill="#888888" font-family="Arial, sans-serif" font-size="11">Initial</text>
  <g transform="translate(80, 25)">
    <rect x="0" y="0" width="50" height="28" rx="3" fill="#e94560"/>
    <text x="25" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">a₁</text>
    
    <rect x="60" y="0" width="50" height="28" rx="3" fill="#e94560"/>
    <text x="85" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">a₂</text>
    
    <rect x="120" y="0" width="50" height="28" rx="3" fill="#e94560"/>
    <text x="145" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">a₃</text>
    
    <rect x="180" y="0" width="50" height="28" rx="3" fill="#e94560"/>
    <text x="205" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">a₄</text>
    
    <rect x="240" y="0" width="50" height="28" rx="3" fill="#e94560"/>
    <text x="265" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">a₅</text>
    
    <rect x="300" y="0" width="50" height="28" rx="3" fill="#e94560"/>
    <text x="325" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">a₆</text>
    
    <rect x="360" y="0" width="50" height="28" rx="3" fill="#e94560"/>
    <text x="385" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">a₇</text>
    
    <rect x="420" y="0" width="50" height="28" rx="3" fill="#e94560"/>
    <text x="445" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="10">a₈</text>
    
    <!-- Lane numbers -->
    <text x="25" y="48" text-anchor="middle" fill="#666" font-family="monospace" font-size="9">lane 1</text>
    <text x="85" y="48" text-anchor="middle" fill="#666" font-family="monospace" font-size="9">lane 2</text>
    <text x="145" y="48" text-anchor="middle" fill="#666" font-family="monospace" font-size="9">lane 3</text>
    <text x="205" y="48" text-anchor="middle" fill="#666" font-family="monospace" font-size="9">lane 4</text>
    <text x="265" y="48" text-anchor="middle" fill="#666" font-family="monospace" font-size="9">lane 5</text>
    <text x="325" y="48" text-anchor="middle" fill="#666" font-family="monospace" font-size="9">lane 6</text>
    <text x="385" y="48" text-anchor="middle" fill="#666" font-family="monospace" font-size="9">lane 7</text>
    <text x="445" y="48" text-anchor="middle" fill="#666" font-family="monospace" font-size="9">lane 8</text>
  </g>
  
  <!-- Step 1: shfl_down by 1 - pairs sum in even lanes -->
  <text x="15" y="115" fill="#888888" font-family="Arial, sans-serif" font-size="11">Step 1</text>
  <text x="15" y="127" fill="#666666" font-family="Arial, sans-serif" font-size="9">offset=1</text>
  <g transform="translate(80, 95)">
    <rect x="0" y="0" width="50" height="28" rx="3" fill="#9b59b6"/>
    <text x="25" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="9">a₁+a₂</text>
    
    <rect x="60" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="85" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="120" y="0" width="50" height="28" rx="3" fill="#9b59b6"/>
    <text x="145" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="9">a₃+a₄</text>
    
    <rect x="180" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="205" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="240" y="0" width="50" height="28" rx="3" fill="#9b59b6"/>
    <text x="265" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="9">a₅+a₆</text>
    
    <rect x="300" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="325" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="360" y="0" width="50" height="28" rx="3" fill="#9b59b6"/>
    <text x="385" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="9">a₇+a₈</text>
    
    <rect x="420" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="445" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
  </g>
  
  <!-- Step 2: shfl_down by 2 -->
  <text x="15" y="185" fill="#888888" font-family="Arial, sans-serif" font-size="11">Step 2</text>
  <text x="15" y="197" fill="#666666" font-family="Arial, sans-serif" font-size="9">offset=2</text>
  <g transform="translate(80, 165)">
    <rect x="0" y="0" width="50" height="28" rx="3" fill="#1abc9c"/>
    <text x="25" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="9">a₁₋₄</text>
    
    <rect x="60" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="85" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="120" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="145" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="180" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="205" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="240" y="0" width="50" height="28" rx="3" fill="#1abc9c"/>
    <text x="265" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="9">a₅₋₈</text>
    
    <rect x="300" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="325" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="360" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="385" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="420" y="0" width="50" height="28" rx="3" fill="#444" stroke="#555" stroke-dasharray="3,2"/>
    <text x="445" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
  </g>
  
  <!-- Step 3: shfl_down by 4 - final result -->
  <text x="15" y="255" fill="#888888" font-family="Arial, sans-serif" font-size="11">Step 3</text>
  <text x="15" y="267" fill="#666666" font-family="Arial, sans-serif" font-size="9">offset=4</text>
  <g transform="translate(80, 235)">
    <rect x="0" y="0" width="50" height="28" rx="3" fill="#27ae60" stroke="#2ecc71" stroke-width="2"/>
    <text x="25" y="18" text-anchor="middle" fill="#fff" font-family="monospace" font-size="9" font-weight="bold">Σaᵢ</text>
    
    <rect x="60" y="0" width="50" height="28" rx="3" fill="#333" stroke="#555" stroke-dasharray="3,2"/>
    <text x="85" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="120" y="0" width="50" height="28" rx="3" fill="#333" stroke="#555" stroke-dasharray="3,2"/>
    <text x="145" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="180" y="0" width="50" height="28" rx="3" fill="#333" stroke="#555" stroke-dasharray="3,2"/>
    <text x="205" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="240" y="0" width="50" height="28" rx="3" fill="#333" stroke="#555" stroke-dasharray="3,2"/>
    <text x="265" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="300" y="0" width="50" height="28" rx="3" fill="#333" stroke="#555" stroke-dasharray="3,2"/>
    <text x="325" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="360" y="0" width="50" height="28" rx="3" fill="#333" stroke="#555" stroke-dasharray="3,2"/>
    <text x="385" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <rect x="420" y="0" width="50" height="28" rx="3" fill="#333" stroke="#555" stroke-dasharray="3,2"/>
    <text x="445" y="18" text-anchor="middle" fill="#666" font-family="monospace" font-size="10">—</text>
    
    <text x="510" y="18" fill="#27ae60" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Lane 1 has total</text>
  </g>
  
  <!-- Summary -->
  <text x="80" y="310" fill="#aaaaaa" font-family="Arial, sans-serif" font-size="11">8 elements → 3 steps = log₂(8)  •  32 elements → 5 steps = log₂(32)</text>
</svg>
