<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550">
  <defs>
    <linearGradient id="gpuGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="smGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0f3460;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1a1a4e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="blockGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a3e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#12122a;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="warpGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e94560;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c73e54;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- GPU Container -->
  <rect x="20" y="20" width="860" height="510" rx="15" fill="url(#gpuGrad)" stroke="#4a4a6a" stroke-width="2"/>
  <text x="450" y="50" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="22" font-weight="bold">GPU</text>
  
  <!-- SM 1 -->
  <rect x="35" y="70" width="260" height="440" rx="10" fill="url(#smGrad)" stroke="#5a5a8a" stroke-width="2"/>
  <text x="165" y="95" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="16" font-weight="bold">SM 1</text>
  
  <!-- Block 1 in SM 1 -->
  <rect x="45" y="110" width="240" height="190" rx="8" fill="url(#blockGrad)" stroke="#f39c12" stroke-width="2"/>
  <text x="165" y="132" text-anchor="middle" fill="#f39c12" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Block 1</text>
  
  <!-- Warps in Block 1 -->
  <rect x="55" y="145" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="107" y="162" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 1</text>
  <text x="107" y="178" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="170" y="145" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="222" y="162" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 2</text>
  <text x="222" y="178" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="55" y="192" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="107" y="209" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 3</text>
  <text x="107" y="225" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="170" y="192" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="222" y="209" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 4</text>
  <text x="222" y="225" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <!-- Shared Memory for Block 1 -->
  <rect x="55" y="240" width="220" height="28" rx="4" fill="#2d4a22" stroke="#4a8a3a" stroke-width="1"/>
  <text x="165" y="259" text-anchor="middle" fill="#aaffaa" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Shared Memory (Block 1)</text>
  
  <text x="165" y="288" text-anchor="middle" fill="#888888" font-family="Arial, sans-serif" font-size="10">@synchronize here</text>

  <!-- Block 2 in SM 1 -->
  <rect x="45" y="310" width="240" height="190" rx="8" fill="url(#blockGrad)" stroke="#3498db" stroke-width="2"/>
  <text x="165" y="332" text-anchor="middle" fill="#3498db" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Block 2</text>
  
  <!-- Warps in Block 2 -->
  <rect x="55" y="345" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="107" y="362" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 1</text>
  <text x="107" y="378" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="170" y="345" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="222" y="362" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 2</text>
  <text x="222" y="378" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="55" y="392" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="107" y="409" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 3</text>
  <text x="107" y="425" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="170" y="392" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="222" y="409" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 4</text>
  <text x="222" y="425" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <!-- Shared Memory for Block 2 -->
  <rect x="55" y="440" width="220" height="28" rx="4" fill="#2d4a22" stroke="#4a8a3a" stroke-width="1"/>
  <text x="165" y="459" text-anchor="middle" fill="#aaffaa" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Shared Memory (Block 2)</text>
  
  <text x="165" y="488" text-anchor="middle" fill="#888888" font-family="Arial, sans-serif" font-size="10">@synchronize here</text>

  <!-- SM 2 -->
  <rect x="320" y="70" width="260" height="440" rx="10" fill="url(#smGrad)" stroke="#5a5a8a" stroke-width="2"/>
  <text x="450" y="95" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="16" font-weight="bold">SM 2</text>
  
  <!-- Block 3 in SM 2 -->
  <rect x="330" y="110" width="240" height="190" rx="8" fill="url(#blockGrad)" stroke="#2ecc71" stroke-width="2"/>
  <text x="450" y="132" text-anchor="middle" fill="#2ecc71" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Block 3</text>
  
  <!-- Warps in Block 3 -->
  <rect x="340" y="145" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="392" y="162" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 1</text>
  <text x="392" y="178" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="455" y="145" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="507" y="162" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 2</text>
  <text x="507" y="178" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="340" y="192" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="392" y="209" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 3</text>
  <text x="392" y="225" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <rect x="455" y="192" width="105" height="40" rx="4" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="507" y="209" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Warp 4</text>
  <text x="507" y="225" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="8">32 threads</text>
  
  <!-- Shared Memory for Block 3 -->
  <rect x="340" y="240" width="220" height="28" rx="4" fill="#2d4a22" stroke="#4a8a3a" stroke-width="1"/>
  <text x="450" y="259" text-anchor="middle" fill="#aaffaa" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Shared Memory (Block 3)</text>

  <!-- Block 4 in SM 2 -->
  <rect x="330" y="310" width="240" height="190" rx="8" fill="url(#blockGrad)" stroke="#9b59b6" stroke-width="2"/>
  <text x="450" y="332" text-anchor="middle" fill="#9b59b6" font-family="Arial, sans-serif" font-size="13" font-weight="bold">Block 4</text>
  
  <!-- Warps in Block 4 (simplified) -->
  <rect x="340" y="345" width="220" height="85" rx="4" fill="#2a1a2a" stroke="#444" stroke-width="1"/>
  <text x="450" y="385" text-anchor="middle" fill="#888888" font-family="Arial, sans-serif" font-size="11">Warps 1-4 (128 threads)</text>
  <text x="450" y="405" text-anchor="middle" fill="#666666" font-family="Arial, sans-serif" font-size="9">...</text>
  
  <!-- Shared Memory for Block 4 -->
  <rect x="340" y="440" width="220" height="28" rx="4" fill="#2d4a22" stroke="#4a8a3a" stroke-width="1"/>
  <text x="450" y="459" text-anchor="middle" fill="#aaffaa" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Shared Memory (Block 4)</text>

  <!-- SM ... -->
  <rect x="605" y="70" width="130" height="440" rx="10" fill="url(#smGrad)" stroke="#5a5a8a" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="670" y="280" text-anchor="middle" fill="#8888aa" font-family="Arial, sans-serif" font-size="20" font-weight="bold">...</text>
  <text x="670" y="310" text-anchor="middle" fill="#8888aa" font-family="Arial, sans-serif" font-size="12">SM n</text>
  
  <!-- Legend -->
  <rect x="750" y="85" width="120" height="180" rx="8" fill="#0a0a15" stroke="#444" stroke-width="1"/>
  <text x="810" y="108" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Legend</text>
  
  <rect x="760" y="120" width="20" height="12" rx="2" fill="url(#smGrad)" stroke="#5a5a8a" stroke-width="1"/>
  <text x="790" y="130" fill="#aaaaaa" font-family="Arial, sans-serif" font-size="9">SM (hardware)</text>
  
  <rect x="760" y="140" width="20" height="12" rx="2" fill="url(#blockGrad)" stroke="#f39c12" stroke-width="1"/>
  <text x="790" y="150" fill="#aaaaaa" font-family="Arial, sans-serif" font-size="9">Block (logical)</text>
  
  <rect x="760" y="160" width="20" height="12" rx="2" fill="url(#warpGrad)" stroke="#ff6b6b" stroke-width="1"/>
  <text x="790" y="170" fill="#aaaaaa" font-family="Arial, sans-serif" font-size="9">Warp (32 thr)</text>
  
  <rect x="760" y="180" width="20" height="12" rx="2" fill="#2d4a22" stroke="#4a8a3a" stroke-width="1"/>
  <text x="790" y="190" fill="#aaaaaa" font-family="Arial, sans-serif" font-size="9">Shared mem</text>
  
  <line x1="760" y1="210" x2="860" y2="210" stroke="#444" stroke-width="1"/>
  <text x="810" y="228" text-anchor="middle" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="8">Shared memory</text>
  <text x="810" y="240" text-anchor="middle" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="8">is per BLOCK</text>
  <text x="810" y="252" text-anchor="middle" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="8">not per SM!</text>
</svg>
