<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 500">
  <defs>
    <linearGradient id="memGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4a1942;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2d1128;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Title -->
  <text x="425" y="35" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="22" font-weight="bold">Latency Hiding: Producer-Consumer Model</text>
  
  <!-- Memory (Producer) -->
  <rect x="580" y="80" width="240" height="380" rx="15" fill="url(#memGrad)" stroke="#9932CC" stroke-width="3"/>
  <text x="700" y="120" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="18" font-weight="bold">MEMORY</text>
  <text x="700" y="145" text-anchor="middle" fill="#ddaadd" font-family="Arial, sans-serif" font-size="14">(Producer)</text>
  
  <!-- Memory queue visualization -->
  <rect x="610" y="170" width="180" height="40" rx="5" fill="#2d1128" stroke="#666" stroke-width="1"/>
  <text x="700" y="195" text-anchor="middle" fill="#ffaa00" font-family="Arial, sans-serif" font-size="12">Request Queue</text>
  
  <rect x="620" y="220" width="35" height="25" rx="3" fill="#e94560" stroke="#ff6b6b" stroke-width="1"/>
  <text x="637" y="237" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">W1</text>
  
  <rect x="660" y="220" width="35" height="25" rx="3" fill="#3498db" stroke="#5dade2" stroke-width="1"/>
  <text x="677" y="237" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">W2</text>
  
  <rect x="700" y="220" width="35" height="25" rx="3" fill="#2ecc71" stroke="#58d68d" stroke-width="1"/>
  <text x="717" y="237" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">W3</text>
  
  <rect x="740" y="220" width="35" height="25" rx="3" fill="#f39c12" stroke="#f7dc6f" stroke-width="1"/>
  <text x="757" y="237" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">W4</text>
  
  <!-- Latency indicator -->
  <rect x="610" y="270" width="180" height="60" rx="5" fill="#1a0a1a" stroke="#9932CC" stroke-width="1"/>
  <text x="700" y="295" text-anchor="middle" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="14" font-weight="bold">~500 cycles</text>
  <text x="700" y="315" text-anchor="middle" fill="#aaaaaa" font-family="Arial, sans-serif" font-size="11">to serve each request</text>
  
  <!-- Data flowing out -->
  <text x="700" y="360" text-anchor="middle" fill="#ddaadd" font-family="Arial, sans-serif" font-size="12">Serves data on demand</text>
  <rect x="650" y="380" width="100" height="30" rx="5" fill="#2d4a22" stroke="#4a8a3a" stroke-width="1"/>
  <text x="700" y="400" text-anchor="middle" fill="#aaffaa" font-family="Arial, sans-serif" font-size="11">â†’ Data out</text>
  
  <!-- Threads (Consumers) -->
  <rect x="30" y="80" width="220" height="380" rx="15" fill="#1a1a2e" stroke="#4a4a6a" stroke-width="3"/>
  <text x="140" y="120" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="18" font-weight="bold">WARPS</text>
  <text x="140" y="145" text-anchor="middle" fill="#aaaadd" font-family="Arial, sans-serif" font-size="14">(Consumers)</text>
  
  <!-- Warp boxes -->
  <rect x="50" y="170" width="180" height="45" rx="5" fill="#e94560" stroke="#ff6b6b" stroke-width="2"/>
  <text x="140" y="190" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Warp 1 (32 threads)</text>
  <text x="140" y="205" text-anchor="middle" fill="#ffcccc" font-family="Arial, sans-serif" font-size="10">Waiting for data...</text>
  
  <rect x="50" y="225" width="180" height="45" rx="5" fill="#3498db" stroke="#5dade2" stroke-width="2"/>
  <text x="140" y="245" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Warp 2 (32 threads)</text>
  <text x="140" y="260" text-anchor="middle" fill="#cce5ff" font-family="Arial, sans-serif" font-size="10">Waiting for data...</text>
  
  <rect x="50" y="280" width="180" height="45" rx="5" fill="#2ecc71" stroke="#58d68d" stroke-width="2"/>
  <text x="140" y="300" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Warp 3 (32 threads)</text>
  <text x="140" y="315" text-anchor="middle" fill="#ccffcc" font-family="Arial, sans-serif" font-size="10">â˜… COMPUTING â˜…</text>
  
  <rect x="50" y="335" width="180" height="45" rx="5" fill="#f39c12" stroke="#f7dc6f" stroke-width="2"/>
  <text x="140" y="355" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Warp 4 (32 threads)</text>
  <text x="140" y="370" text-anchor="middle" fill="#fff5cc" font-family="Arial, sans-serif" font-size="10">Waiting for data...</text>
  
  <text x="140" y="410" text-anchor="middle" fill="#888888" font-family="Arial, sans-serif" font-size="14">... more warps ...</text>
  
  <!-- Arrows: requests going to memory -->
  <defs>
    <marker id="arrowRight" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#ffaa00" />
    </marker>
    <marker id="arrowLeft" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto">
      <path d="M9,0 L9,6 L0,3 z" fill="#00ff00" />
    </marker>
  </defs>
  
  <!-- Request arrows -->
  <path d="M 250 190 C 350 190, 450 170, 580 190" stroke="#ffaa00" stroke-width="2" fill="none" marker-end="url(#arrowRight)" stroke-dasharray="5,3"/>
  <path d="M 250 245 C 350 220, 450 200, 580 215" stroke="#ffaa00" stroke-width="2" fill="none" marker-end="url(#arrowRight)" stroke-dasharray="5,3"/>
  <path d="M 250 355 C 350 340, 450 280, 580 240" stroke="#ffaa00" stroke-width="2" fill="none" marker-end="url(#arrowRight)" stroke-dasharray="5,3"/>
  
  <!-- Data return arrow -->
  <path d="M 580 400 C 450 420, 350 380, 250 300" stroke="#00ff00" stroke-width="3" fill="none" marker-end="url(#arrowLeft)"/>
  
  <!-- Labels for arrows -->
  <text x="400" y="160" text-anchor="middle" fill="#ffaa00" font-family="Arial, sans-serif" font-size="11">Memory requests</text>
  <text x="400" y="430" text-anchor="middle" fill="#00ff00" font-family="Arial, sans-serif" font-size="11">Data returned</text>
  
  <!-- Key insight box -->
  <rect x="280" y="260" width="280" height="90" rx="10" fill="#0a2a0a" stroke="#00aa00" stroke-width="2"/>
  <text x="420" y="285" text-anchor="middle" fill="#00ff00" font-family="Arial, sans-serif" font-size="13" font-weight="bold">ðŸ’¡ KEY INSIGHT</text>
  <text x="420" y="305" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="11">While warps 1, 2, 4 WAIT for memory,</text>
  <text x="420" y="322" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="11">warp 3 COMPUTES!</text>
  <text x="420" y="342" text-anchor="middle" fill="#aaffaa" font-family="Arial, sans-serif" font-size="10">â†’ GPU is never idle</text>
</svg>
